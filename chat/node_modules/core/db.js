var os = require('os');
const mysql = require("mysql2");
var config = require("../../config.json");
var hostname = os.hostname();
console.log(hostname);
var ip = require('ip');
var db;

exports.connectDB = _0x2b5aca => {
  return new Promise((_0x3eb717, _0x1b6fa0) => {
    if (hostname == 'DESKTOP-MRLV3Q3') {
      db = mysql.createConnection({
        host: config.db.dev.host,
        user: config.db.dev.user,
        password: config.db.dev.password,
        database: config.db.dev.database
      });
    } else {
      db = mysql.createConnection({
        host: config.db.live.host,
        user: config.db.live.user,
        password: config.db.live.password,
        database: config.db.live.database
      });
    }
    STORAGE_URL = config.storageUrl;

    db.connect(function (_0x21118b) {
      if (_0x21118b) {
        console.log(_0x21118b);
      }
      db.query("SELECT * FROM setting", function (_0x1305dd, _0x38d974) {
        if (_0x1305dd) {
          throw _0x1305dd;
        }
        var _0x3b1ed4 = _0x38d974[0].site_url;
        var _0x1b2b24 = _0x38d974[0].storage_system;
        if (STORAGE_URL == '') {
          if (_0x1b2b24 == 1) {
            STORAGE_URL = _0x3b1ed4 + "/uploads";
          } else if (_0x1b2b24 == 2) {
            STORAGE_URL = _0x38d974[0].aws_access_url;
          } else if (_0x1b2b24 == 3) {
            STORAGE_URL = 'https://' + _0x38d974[0].azure_account_name + ".blob.core.windows.net/" + _0x38d974[0].azure_container;
          }
        }

      });
    });

    _0x3eb717(db);
  });
};
